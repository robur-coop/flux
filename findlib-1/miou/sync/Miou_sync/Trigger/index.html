<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Trigger (docs.findlib-1.miou.sync.Miou_sync.Trigger)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 3.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../../../../index.html">Index</a> &#x00BB; <a href="../../../../../index.html">docs</a> &#x00BB; <a href="../../../../index.html">findlib-1</a> &#x00BB; <a href="../../../index.html">miou</a> &#x00BB; <a href="../../index.html">sync</a> &#x00BB; <a href="../index.html">Miou_sync</a> &#x00BB; Trigger</nav><header class="odoc-preamble"><h1>Module <code><span>Miou_sync.Trigger</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-create"><a href="#val-create" class="anchor"></a><code><span><span class="keyword">val</span> create : <span>unit <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>create ()</code> allocates a new trigger in the initial state.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_initial"><a href="#val-is_initial" class="anchor"></a><code><span><span class="keyword">val</span> is_initial : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>is_initial t</code> determines whether the trigger <code>t</code> is in the initial state.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_signaled"><a href="#val-is_signaled" class="anchor"></a><code><span><span class="keyword">val</span> is_signaled : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>is_signaled t</code> determines whether the trigger <code>t</code> is in the signaled state.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-await"><a href="#val-await" class="anchor"></a><code><span><span class="keyword">val</span> await : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(exn * <a href="../../../../../stdlib/Stdlib/Printexc/index.html#type-raw_backtrace">Printexc.raw_backtrace</a>)</span> option</span></span></code></div><div class="spec-doc"><p><code>await t</code> waits for the trigger to be <a href="#val-signal"><code>signal</code></a>ed.</p><p>The return value is <code>None</code> in case the trigger was signaled before <code>await</code> or we resumed the underlying continuation normally. Otherwise, the return value is <code>Some (exn, bt)</code>, which indicates that the underlying continuation has been cancelled and the caller should raise the exception. In either case, the caller is responsible for cleaning up. Usually this means making sure that no references to the trigger remain to avoid space leak.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <a href="../../../../../stdlib/Stdlib/index.html#exception-Invalid_argument"><code>Invalid_argument</code></a> <p>if the trigger was in the awaiting state, which means that multiple concurrent calls of <code>await</code> are being made.</p></li></ul></div></div><div class="odoc-spec"><div class="spec type extension anchored" id="extension-decl-Await"><a href="#extension-decl-Await" class="anchor"></a><code><span><span class="keyword">type</span> <a href="../../../../../stdlib/Stdlib/Effect/index.html#type-t">Effect.t</a> += <span class="keyword">private</span> </span></code><ol><li id="extension-Await" class="def variant extension anchored"><a href="#extension-Await" class="anchor"></a><code><span>| </span><span><span class="extension">Await</span> : <a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span> <span><span><span>(exn * <a href="../../../../../stdlib/Stdlib/Printexc/index.html#type-raw_backtrace">Printexc.raw_backtrace</a>)</span> option</span> <a href="../../../../../stdlib/Stdlib/Effect/index.html#type-t">Effect.t</a></span></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-signal"><a href="#val-signal" class="anchor"></a><code><span><span class="keyword">val</span> signal : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>After <code>signal t</code> returns, the trigger has been put into the signaled state and any attached action (via <a href="#val-on_signal"><code>on_signal</code></a>) has been called.</p><p>Note that under normal circumstance, <code>signal</code> should never raise an exception. If an exception is raised by <code>signal</code>, it means that the attached action raised an error.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-on_signal"><a href="#val-on_signal" class="anchor"></a><code><span><span class="keyword">val</span> on_signal : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'x</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'y</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'x</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'y</span> <span class="arrow">&#45;&gt;</span></span> unit)</span> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>on_signal t x y fn</code> attempts to attach the <code>fn</code> action to the trigger <code>t</code> and transition the trigger to the awaiting state. It must be safe to call <code>fn t x y</code> from any context that <a href="#val-signal"><code>signal</code></a> might be called from.</p><p>The return value is <code>true</code> in case the action was attached successfully. Otherwise, the return value is <code>false</code>, which means that the trigger was already in the signaled state.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <a href="../../../../../stdlib/Stdlib/index.html#exception-Invalid_argument"><code>Invalid_argument</code></a> <p>if the trigger was in the awaiting state, which means that either the owner or creator of the trigger made concurrent calls to <a href="#val-await"><code>await</code></a> or the handler called <code>on_signal</code> more than once.</p></li></ul></div></div></div></body></html>
